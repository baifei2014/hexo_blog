---
title: Mysql Innodb引擎事务隔离级别
tags: [MySQL, Innodb, 隔离级别]
date: 2019-03-18 15:32:45
---

事务在数据库应用中非常重要，能实现数据完整性，但是在使用事务时，如果不考虑隔离级别，就会带来很多问题：
## 1，脏读
脏读是指一个事务读取了另一个事务未提交的数据，这是非常危险的，比如说，商家进行商品改价，价格操作增加100，更新商品价格sql如下
begin;
update goods_price = goods_price + 100 where seller_uid = 97947;

这时还未提交，顾客购买此商家的商品，付款时查询商品价格就是增加100后的价格，如果顾客付款后，商家改价事务没有提交，那么顾客就会发现自己多付了100元；
## 2，不可重复读
在说不可重复读之前，先说一下可重复读，可重复读是指同一事务在并发读取数据时，会看到相同的数据行；不可重复读指一个事务内读取表中同一行数据，多次读取结果不同。
## 3，幻读
幻读是指一个事务读取了别的事务插入的数据，前后读取数据不一致；

这里说一下不可重复读和幻读的区别，虽然都是一个事务内前后读取数据不一致，但是不可重复读在于更新(update)和删除(delete)，而幻读在于新增(insert)。

在数据库系统中，为了并发读数据的正确性，构建了不同层级的隔离级别，通过数据库锁，来实现不同隔离级别下读数据的准确性
| 隔离级别 | 脏读 | 不可重复读 | 幻读 |
| ------- | --: | --------: | --: |
| 未提交读 | 可能 | 可能 | 可能 |
| 已提交读 | 不可能 | 可能 | 可能 |
| 可重复读 | 不可能 | 不可能 | 可能 |
| 串行化 | 不可能 | 不可能 | 不可能 |

未提交读(Read Uncommitted)
未提交读隔离级别最低，会读取到别的事务未提交的数据，也就是脏读，产生各种问题，一般数据库不会使用。
已提交读(Read Committed)
已提交读只能读取已提交的数据，数据的读取不会加锁，数据的写入，修改和删除都会加锁；已提交读的问题就是虽然避免了数据的脏读，但是还是会出现不可重复读，同一个事务内，前后读取价格金额不相同，这就是因为在已提交读模式下，读取到了事务2已提交的数据。
可重复读(Repeatable Read)
可重复读避免了同一事务内多次读取数据不同的情况，查询都是和事务开始时一致的，可重复读也是mysql的Innodb引擎默认的隔离级别。
可串行读(Serializable)
可串行读隔离级别最高，每次读写都会获取表级锁，并发能力非常差。










